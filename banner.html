<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Banner Test</title>
<style>
  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
  }

  #banner-slot {
    position: relative;
    width: 100%;
    max-height: 250px;
    overflow: hidden;
    background: #000;
  }

  #banner-slot img {
    width: 100%;
    max-height: 250px;
    display: block;
    opacity: 0;
    transition: opacity 1s ease-in-out;
  }

  #banner-slot img.active {
    opacity: 1;
  }

  .tag {
    position: absolute;
    top: 4px;
    right: 4px;
    background: rgba(0,0,0,0.6);
    color: white;
    font-size: 12px;
    padding: 3px 6px;
    border-radius: 4px;
    text-decoration: none;
  }

  .wrapper {
    position: relative;
  }
</style>
</head>
<body>

<div id="banner-slot">
  <p style="color:white;text-align:center;padding:100px 0;">Loading banner...</p>
</div>

<script src="data/banners.js"></script>
<script>
(function() {
  const slot = document.getElementById('banner-slot');
  const REFRESH_INTERVAL = 15000; // 15 seconds for testing
  let currentIndex = -1;

  function loadNextBanner() {
    const now = new Date();
    const validBanners = (window.banners || []).filter(b => new Date(b.expiry) > now);
    if (!validBanners.length) {
      slot.innerHTML = "<p style='color:white;text-align:center;'>No active banners</p>";
      return;
    }

    currentIndex = (currentIndex + 1) % validBanners.length;
    const banner = validBanners[currentIndex];

    slot.innerHTML = `
      <div class="wrapper">
        <a href="${banner.link}" target="_blank">
          <img src="${banner.img}" alt="Banner">
        </a>
        <a href="https://aksharhanumandham.in/advertise.html" class="tag" target="_blank">Sponsored Ad</a>
      </div>
    `;

    const img = slot.querySelector("img");
    img.onload = () => img.classList.add("active");
  }

  window.addEventListener("load", function() {
    loadNextBanner();
    setInterval(loadNextBanner, REFRESH_INTERVAL);
  });
})();
</script>
</body>
</html>
